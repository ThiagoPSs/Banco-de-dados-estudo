--Create table emp as select* from scott.emp

--create view vemp as select * from scott.emp

--Select * from vemp

--Create table dept as select * from scott.dept

--Select * from dept

--Create view vempdep1 as select emp.ENAME, emp.DEPTNO, dept.DNAME from dept inner join emp on dept.DEPTNO = emp.DEPTNO;

--select * from vempdep1

--Create view vempdep2 as select emp.*, dept.DNAME from dept inner join emp on dept.DEPTNO = emp.DEPTNO;

--select * from vempdep2;

/*CREATE TABLE EMPLOYEES
AS SELECT * FROM HR.EMPLOYEES;
CREATE TABLE DEPARTMENTS
AS SELECT * FROM HR.DEPARTMENTS;
CREATE TABLE REGIONS
AS SELECT * FROM HR.REGIONS;
CREATE TABLE JOBS
AS SELECT * FROM HR.JOBS;
CREATE TABLE LOCATIONS
AS SELECT * FROM HR.LOCATIONS;
CREATE TABLE COUNTRIES
AS SELECT * FROM HR.COUNTRIES; */


/*
SELECT * FROM EMPLOYEES;
SELECT * FROM DEPARTMENTS;
SELECT * FROM REGIONS;
SELECT * FROM JOBS;
SELECT * FROM LOCATIONS;
SELECT * FROM COUNTRIES; */

/*
CREATE VIEW VEMPLOYEES
AS SELECT E.EMPLOYEE_ID, E.FIRST_NAME, E.LAST_NAME, E.EMAIL,
E.HIRE_DATE, J.JOB_TITLE, E.SALARY, D.DEPARTMENT_NAME
FROM EMPLOYEES E INNER JOIN JOBS J
ON E.JOB_ID = J.JOB_ID
INNER JOIN DEPARTMENTS D
ON D.DEPARTMENT_ID = E.DEPARTMENT_ID; */

--select * from vemployees

/*
CREATE VIEW VLOCATIONS
AS SELECT L.LOCATION_ID, L.STREET_ADDRESS, L.POSTAL_CODE, L.CITY,
L.STATE_PROVINCE, C.COUNTRY_NAME, R.REGION_NAME
FROM LOCATIONS L INNER JOIN COUNTRIES C
ON L.COUNTRY_ID = C.COUNTRY_ID
INNER JOIN REGIONS R 
ON C.REGION_ID = R.REGION_ID;*/
--select * from vlocations

--SELECT * FROM VLOCATIONS
--WHERE REGION_NAME IN ('Americas', 'Europe');
--SELECT * FROM VEMPLOYEES
--WHERE JOB_TITLE LIKE '%Sales%';

--CRIAR TABELA FUNCIONÁRIOS

/*
CREATE TABLE FUNCIONARIO (
CODIGO NUMBER ,
NOME VARCHAR(150),
COD_CARGO NUMBER,
CONSTRAINT PK_FUNCIONARIO PRIMARY KEY (CODIGO)
);
-- INSERÇÃO
INSERT INTO FUNCIONARIO (CODIGO, NOME, COD_CARGO) VALUES (1, 'JOÃO DA SILVA', 2);
INSERT INTO FUNCIONARIO (CODIGO, NOME, COD_CARGO) VALUES (2, 'MARIA DOS SANTOS', 3);
INSERT INTO FUNCIONARIO (CODIGO, NOME, COD_CARGO) VALUES (3, 'JOSÉ GOMES', 1);
INSERT INTO FUNCIONARIO (CODIGO, NOME, COD_CARGO) VALUES (4, 'MÁRIO SANTANA', 5);
INSERT INTO FUNCIONARIO (CODIGO, NOME, COD_CARGO) VALUES (5, 'JOANA SILVEIRA', 4);
INSERT INTO FUNCIONARIO (CODIGO, NOME, COD_CARGO) VALUES (6, 'PEDRO GOMES', 6);
INSERT INTO FUNCIONARIO (CODIGO, NOME, COD_CARGO) VALUES (7, 'JOAQUIM DE ALMEIDA', NULL);
*/
/*
SELECT CODIGO, NOME,
CASE COD_CARGO
WHEN 1 THEN 'ENGENHEIRO'
WHEN 2 THEN 'ANALISTA DE SISTEMAS'
WHEN 3 THEN 'ADVOGADO'
WHEN 4 THEN 'CONTADOR'
WHEN 5 THEN 'ADMINISTRADOR'
ELSE 'INDEFINIDO' END AS CARGO
FROM FUNCIONARIO; */

--select * from funcionario

/*
Alter table funcionario add status number;
Update funcionario set status = 0 where CODIGO in (1,4,7);
Update funcionario set status = 1 where codigo not in(1,4,7) */

/*
CREATE VIEW VFUNCIONARIO AS
SELECT CODIGO, NOME,
CASE COD_CARGO
WHEN 1 THEN 'ENGENHEIRO'
WHEN 2 THEN 'ANALISTA DE SISTEMAS'
WHEN 3 THEN 'ADVOGADO'
WHEN 4 THEN 'CONTADOR'
WHEN 5 THEN 'ADMINISTRADOR'
ELSE 'INDEFINIDO' END AS CARGO,
CASE STATUS
WHEN 0 THEN 'INATIVO'
WHEN 1 THEN 'ATIVO'
ELSE 'INDEFINIDO' END AS STATUS
FROM FUNCIONARIO; */
--select * from funcionario
--select * from vfuncionario where Status = 'INATIVO';
--create view vstatus as select count(*) as qtde, status from vfuncionario group by status;

